<!doctype html>
<html
  lang="en-us"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="dark"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en-us">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title>Part 8: Caching and Incremental Compilation &middot; Yohai&#39;s Blog</title>
    <meta name="title" content="Part 8: Caching and Incremental Compilation &middot; Yohai&#39;s Blog">
  

  
  
  
  
  
  <link rel="canonical" href="http://localhost:1313/drafts/08-caching-incremental/">
  

  
  
    <meta name="author" content="Yohai">
  
  

  
  <meta property="og:url" content="http://localhost:1313/drafts/08-caching-incremental/">
  <meta property="og:site_name" content="Yohai&#39;s Blog">
  <meta property="og:title" content="Part 8: Caching and Incremental Compilation">
  <meta property="og:description" content="Part 8: Caching and Incremental Compilation # In this article, we’ll explore how Zig achieves remarkably fast compilation through smart caching and incremental compilation. This is the “payoff” - it explains why the previous articles’ design decisions were made.
Part 1: Why Does Compilation Speed Matter? # The Problem with Traditional Compilers # Imagine you’re working on a large project with 1000 source files. You change ONE line in ONE file. What happens?">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="drafts">
    <meta property="article:published_time" content="2025-12-17T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-12-17T00:00:00+00:00">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Part 8: Caching and Incremental Compilation">
  <meta name="twitter:description" content="Part 8: Caching and Incremental Compilation # In this article, we’ll explore how Zig achieves remarkably fast compilation through smart caching and incremental compilation. This is the “payoff” - it explains why the previous articles’ design decisions were made.
Part 1: Why Does Compilation Speed Matter? # The Problem with Traditional Compilers # Imagine you’re working on a large project with 1000 source files. You change ONE line in ONE file. What happens?">

  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
  
    
  

  
  
  
  
  
  

  

  
  
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.0975a8c7c266a0697f94839b45e1574c449de253527d44ed516d5c5c3c820c9389d7d86576faae12267b129f8749ecbf7581cddb636aba7690aa633b95aaa87d.css"
    integrity="sha512-CXWox8JmoGl/lIObReFXTESd4lNSfUTtUW1cXDyCDJOJ19hldvquEiZ7Ep&#43;HSey/dYHN22NqunaQqmM7laqofQ==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js"
    integrity="sha512-b0EXSzoFtoCCD&#43;CMrb&#43;l&#43;3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
  
    
  
  
    
  
  
    
  
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.9cc802d09f28c6af56ceee7bc6e320a39251fdae98243f2a9942f221ac57a9f49c51609699a91794a7b2580ee1deaa8e4d794a68ffa94aa317c66e893ce51e02.js"
      integrity="sha512-nMgC0J8oxq9Wzu57xuMgo5JR/a6YJD8qmULyIaxXqfScUWCWmakXlKeyWA7h3qqOTXlKaP&#43;pSqMXxm6JPOUeAg=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  

<script src="/lib/jquery/jquery.slim.min.b0dca576e87d7eaa5850ae4e61759c065786cdb6489d68fcc82240539eebd5da522bdb4fda085ffd245808c8fe2acb2516408eb774ef26b5f6015fc6737c0ea8.js" integrity="sha512-sNylduh9fqpYUK5OYXWcBleGzbZInWj8yCJAU57r1dpSK9tP2ghf/SRYCMj&#43;KsslFkCOt3TvJrX2AV/Gc3wOqA=="></script>


























  

  

  

  

  





  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Drafts",
    "name": "Part 8: Caching and Incremental Compilation",
    "headline": "Part 8: Caching and Incremental Compilation",
    
    "abstract": "\u003ch1 class=\u0022relative group\u0022\u003ePart 8: Caching and Incremental Compilation\n    \u003cdiv id=\u0022part-8-caching-and-incremental-compilation\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\u0022\u003e\n        \u003ca class=\u0022text-primary-300 dark:text-neutral-700 !no-underline\u0022 href=\u0022#part-8-caching-and-incremental-compilation\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e\n    \n\u003c\/h1\u003e\n\u003cp\u003eIn this article, we\u0026rsquo;ll explore how Zig achieves remarkably fast compilation through smart caching and incremental compilation. This is the \u0026ldquo;payoff\u0026rdquo; - it explains \u003cem\u003ewhy\u003c\/em\u003e the previous articles\u0026rsquo; design decisions were made.\u003c\/p\u003e\n\u003chr\u003e\n\n\u003ch2 class=\u0022relative group\u0022\u003ePart 1: Why Does Compilation Speed Matter?\n    \u003cdiv id=\u0022part-1-why-does-compilation-speed-matter\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\u0022\u003e\n        \u003ca class=\u0022text-primary-300 dark:text-neutral-700 !no-underline\u0022 href=\u0022#part-1-why-does-compilation-speed-matter\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e\n    \n\u003c\/h2\u003e\n\n\u003ch3 class=\u0022relative group\u0022\u003eThe Problem with Traditional Compilers\n    \u003cdiv id=\u0022the-problem-with-traditional-compilers\u0022 class=\u0022anchor\u0022\u003e\u003c\/div\u003e\n    \n    \u003cspan\n        class=\u0022absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none\u0022\u003e\n        \u003ca class=\u0022text-primary-300 dark:text-neutral-700 !no-underline\u0022 href=\u0022#the-problem-with-traditional-compilers\u0022 aria-label=\u0022Anchor\u0022\u003e#\u003c\/a\u003e\n    \u003c\/span\u003e\n    \n\u003c\/h3\u003e\n\u003cp\u003eImagine you\u0026rsquo;re working on a large project with 1000 source files. You change ONE line in ONE file. What happens?\u003c\/p\u003e",
    "inLanguage": "en-us",
    "url" : "http://localhost:1313/drafts/08-caching-incremental/",
    "author" : {
      "@type": "Person",
      "name": "Yohai"
    },
    "copyrightYear": "2025",
    "dateCreated": "2025-12-17T00:00:00\u002b00:00",
    "datePublished": "2025-12-17T00:00:00\u002b00:00",
    
    "dateModified": "2025-12-17T00:00:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "3450"
  }]
  </script>



  
  

  
  

  
  

  
  

  
  
</head>


















  
  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      













<div
  class="main-menu flex items-center justify-between py-6 md:justify-start gap-x-3 pt-[2px] pr-2 md:pr-4 pb-[3px] pl-0">
  
  

  <div class="flex flex-1 items-center justify-between">
    <nav class="flex space-x-3">
      
        <a href="/" class="text-base font-medium">
          Yohai&rsquo;s Blog
        </a>
      
    </nav>
    
  <nav class="hidden md:flex items-center gap-x-5 md:ml-12 h-12">
    
      
        
  <a
  href="/posts/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Posts"
  title="Posts">
  
  
    <p class="text-base font-medium">
      Posts
    </p>
  
</a>



      
        
  <a
  href="/drafts/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Drafts"
  title="Drafts">
  
  
    <p class="text-base font-medium">
      Drafts
    </p>
  
</a>



      
        
  <a
  href="/tags/"
  
  class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
  aria-label="Tags"
  title="Tags">
  
  
    <p class="text-base font-medium">
      Tags
    </p>
  
</a>



      
    

    

    

    
      <button
        id="search-button"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <div class=" flex items-center">
        <button
          id="appearance-switcher"
          aria-label="Dark mode switcher"
          type="button"
          class="text-base hover:text-primary-600 dark:hover:text-primary-400">
          <div class="flex items-center justify-center dark:hidden">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
          </div>
          <div class="items-center justify-center hidden dark:flex">
            <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
          </div>
        </button>
      </div>
    
  </nav>

    
  <div class="flex md:hidden items-center gap-x-5 md:ml-12 h-12">
    <span></span>

    

    

    
      <button
        id="search-button-mobile"
        aria-label="Search"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400"
        title="Search (/)">
        <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
      </button>
    

    
      <button
        id="appearance-switcher-mobile"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base hover:text-primary-600 dark:hover:text-primary-400 me-1">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    
  </div>

  </div>
  
  <div class="-my-2 md:hidden">
    <div id="menu-button" class="block">
      
        <div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
        </div>
        <div
          id="menu-wrapper"
          class="fixed inset-0 z-30 invisible w-screen h-screen m-0 overflow-auto transition-opacity opacity-0 cursor-default bg-neutral-100/50 backdrop-blur-sm dark:bg-neutral-900/50 pt-[5px]">
          <ul
            class="flex space-y-2 mt-3 flex-col items-end w-full px-6 py-6 mx-auto overflow-visible list-none text-end max-w-7xl">
            <li id="menu-close-button">
              <span
                class="cursor-pointer inline-block align-text-bottom hover:text-primary-600 dark:hover:text-primary-400">
                <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
              </span>
            </li>

            
              
  <li class="mt-1">
  <a
    href="/posts/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Posts"
    title="Posts">
    
    
      <p class="text-bg font-bg">
        Posts
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/drafts/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Drafts"
    title="Drafts">
    
    
      <p class="text-bg font-bg">
        Drafts
      </p>
    
  </a>
</li>



            
              
  <li class="mt-1">
  <a
    href="/tags/"
    
    class="flex items-center hover:text-primary-600 dark:hover:text-primary-400"
    aria-label="Tags"
    title="Tags">
    
    
      <p class="text-bg font-bg">
        Tags
      </p>
    
  </a>
</li>



            

          </ul>
          
        </div>
      
    </div>
  </div>

</div>





    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
        <ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden">
  
  
    
  
    
  
  <li class="hidden">
    <a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href="/"
      >Yohai&#39;s Blog</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="inline">
    <a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href="/drafts/"
      >Drafts</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

  
  <li class="hidden">
    <a class="hover:underline decoration-neutral-300 dark:underline-neutral-600" href="/drafts/08-caching-incremental/"
      >Part 8: Caching and Incremental Compilation</a
    ><span class="px-1 text-primary-500">/</span>
  </li>

</ol>


      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Part 8: Caching and Incremental Compilation
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2025-12-17T00:00:00&#43;00:00">December 17, 2025</time><span class="px-2 text-primary-500">&middot;</span><span>3450 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">17 mins</span>
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  
    
    
<div class="flex author">
  
  <div class="place-self-center">
    
      <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        Author
      </div>
      <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        Yohai
      </div>
    
    
    <div class="text-2xl sm:text-lg">
</div>
  </div>
</div>

  

  

  
    <div class="mb-5"></div>
  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ml-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-10">
            
              <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain scrollbar-thin scrollbar-track-neutral-200 scrollbar-thumb-neutral-400 dark:scrollbar-track-neutral-800 dark:scrollbar-thumb-neutral-600 rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#part-1-why-does-compilation-speed-matter">Part 1: Why Does Compilation Speed Matter?</a>
      <ul>
        <li><a href="#the-problem-with-traditional-compilers">The Problem with Traditional Compilers</a></li>
        <li><a href="#the-core-insight">The Core Insight</a></li>
      </ul>
    </li>
    <li><a href="#part-2-the-zig-cache-directory">Part 2: The Zig Cache Directory</a>
      <ul>
        <li><a href="#whats-in-each-directory">What&rsquo;s in Each Directory?</a></li>
      </ul>
    </li>
    <li><a href="#part-3-how-hashing-works">Part 3: How Hashing Works</a>
      <ul>
        <li><a href="#what-gets-hashed">What Gets Hashed?</a></li>
        <li><a href="#example-computing-a-cache-key">Example: Computing a Cache Key</a></li>
        <li><a href="#why-content-not-timestamps">Why Content, Not Timestamps?</a></li>
      </ul>
    </li>
    <li><a href="#part-4-the-compilation-cache-layers">Part 4: The Compilation Cache Layers</a>
      <ul>
        <li><a href="#layer-1-zir-cache">Layer 1: ZIR Cache</a></li>
        <li><a href="#layer-2-semantic-analysis-cache">Layer 2: Semantic Analysis Cache</a></li>
        <li><a href="#layer-3-code-generation-cache">Layer 3: Code Generation Cache</a></li>
        <li><a href="#layer-4-incremental-linking">Layer 4: Incremental Linking</a></li>
      </ul>
    </li>
    <li><a href="#part-5-dependency-tracking">Part 5: Dependency Tracking</a>
      <ul>
        <li><a href="#the-dependency-graph">The Dependency Graph</a></li>
        <li><a href="#what-happens-when-a-file-changes">What Happens When a File Changes?</a></li>
        <li><a href="#fine-grained-vs-coarse-grained">Fine-Grained vs Coarse-Grained</a></li>
      </ul>
    </li>
    <li><a href="#part-6-the-internpool---deduplication-magic">Part 6: The InternPool - Deduplication Magic</a>
      <ul>
        <li><a href="#how-internpool-helps-caching">How InternPool Helps Caching</a></li>
      </ul>
    </li>
    <li><a href="#part-7-incremental-compilation-in-action">Part 7: Incremental Compilation in Action</a>
      <ul>
        <li><a href="#initial-compilation-cold-cache">Initial Compilation (Cold Cache)</a></li>
        <li><a href="#incremental-build-warm-cache-small-change">Incremental Build (Warm Cache, Small Change)</a></li>
        <li><a href="#the-speedup-scales">The Speedup Scales</a></li>
      </ul>
    </li>
    <li><a href="#part-8-cache-invalidation-strategies">Part 8: Cache Invalidation Strategies</a>
      <ul>
        <li><a href="#the-two-hard-problems-in-computer-science">The Two Hard Problems in Computer Science</a></li>
        <li><a href="#zigs-invalidation-rules">Zig&rsquo;s Invalidation Rules</a></li>
        <li><a href="#what-doesnt-invalidate-cache">What DOESN&rsquo;T Invalidate Cache</a></li>
      </ul>
    </li>
    <li><a href="#part-9-parallel-compilation">Part 9: Parallel Compilation</a>
      <ul>
        <li><a href="#cache--parallelism--speed">Cache + Parallelism = Speed</a></li>
      </ul>
    </li>
    <li><a href="#part-10-debugging-cache-issues">Part 10: Debugging Cache Issues</a>
      <ul>
        <li><a href="#forcing-a-clean-build">Forcing a Clean Build</a></li>
        <li><a href="#understanding-cache-misses">Understanding Cache Misses</a></li>
        <li><a href="#cache-inspection-advanced">Cache Inspection (Advanced)</a></li>
      </ul>
    </li>
    <li><a href="#part-11-the-complete-picture">Part 11: The Complete Picture</a>
      <ul>
        <li><a href="#why-each-design-decision-matters">Why Each Design Decision Matters</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#part-1-why-does-compilation-speed-matter">Part 1: Why Does Compilation Speed Matter?</a>
      <ul>
        <li><a href="#the-problem-with-traditional-compilers">The Problem with Traditional Compilers</a></li>
        <li><a href="#the-core-insight">The Core Insight</a></li>
      </ul>
    </li>
    <li><a href="#part-2-the-zig-cache-directory">Part 2: The Zig Cache Directory</a>
      <ul>
        <li><a href="#whats-in-each-directory">What&rsquo;s in Each Directory?</a></li>
      </ul>
    </li>
    <li><a href="#part-3-how-hashing-works">Part 3: How Hashing Works</a>
      <ul>
        <li><a href="#what-gets-hashed">What Gets Hashed?</a></li>
        <li><a href="#example-computing-a-cache-key">Example: Computing a Cache Key</a></li>
        <li><a href="#why-content-not-timestamps">Why Content, Not Timestamps?</a></li>
      </ul>
    </li>
    <li><a href="#part-4-the-compilation-cache-layers">Part 4: The Compilation Cache Layers</a>
      <ul>
        <li><a href="#layer-1-zir-cache">Layer 1: ZIR Cache</a></li>
        <li><a href="#layer-2-semantic-analysis-cache">Layer 2: Semantic Analysis Cache</a></li>
        <li><a href="#layer-3-code-generation-cache">Layer 3: Code Generation Cache</a></li>
        <li><a href="#layer-4-incremental-linking">Layer 4: Incremental Linking</a></li>
      </ul>
    </li>
    <li><a href="#part-5-dependency-tracking">Part 5: Dependency Tracking</a>
      <ul>
        <li><a href="#the-dependency-graph">The Dependency Graph</a></li>
        <li><a href="#what-happens-when-a-file-changes">What Happens When a File Changes?</a></li>
        <li><a href="#fine-grained-vs-coarse-grained">Fine-Grained vs Coarse-Grained</a></li>
      </ul>
    </li>
    <li><a href="#part-6-the-internpool---deduplication-magic">Part 6: The InternPool - Deduplication Magic</a>
      <ul>
        <li><a href="#how-internpool-helps-caching">How InternPool Helps Caching</a></li>
      </ul>
    </li>
    <li><a href="#part-7-incremental-compilation-in-action">Part 7: Incremental Compilation in Action</a>
      <ul>
        <li><a href="#initial-compilation-cold-cache">Initial Compilation (Cold Cache)</a></li>
        <li><a href="#incremental-build-warm-cache-small-change">Incremental Build (Warm Cache, Small Change)</a></li>
        <li><a href="#the-speedup-scales">The Speedup Scales</a></li>
      </ul>
    </li>
    <li><a href="#part-8-cache-invalidation-strategies">Part 8: Cache Invalidation Strategies</a>
      <ul>
        <li><a href="#the-two-hard-problems-in-computer-science">The Two Hard Problems in Computer Science</a></li>
        <li><a href="#zigs-invalidation-rules">Zig&rsquo;s Invalidation Rules</a></li>
        <li><a href="#what-doesnt-invalidate-cache">What DOESN&rsquo;T Invalidate Cache</a></li>
      </ul>
    </li>
    <li><a href="#part-9-parallel-compilation">Part 9: Parallel Compilation</a>
      <ul>
        <li><a href="#cache--parallelism--speed">Cache + Parallelism = Speed</a></li>
      </ul>
    </li>
    <li><a href="#part-10-debugging-cache-issues">Part 10: Debugging Cache Issues</a>
      <ul>
        <li><a href="#forcing-a-clean-build">Forcing a Clean Build</a></li>
        <li><a href="#understanding-cache-misses">Understanding Cache Misses</a></li>
        <li><a href="#cache-inspection-advanced">Cache Inspection (Advanced)</a></li>
      </ul>
    </li>
    <li><a href="#part-11-the-complete-picture">Part 11: The Complete Picture</a>
      <ul>
        <li><a href="#why-each-design-decision-matters">Why Each Design Decision Matters</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>
  </div>
</details>



            
          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        

        <div class="article-content max-w-prose mb-20">
          
<h1 class="relative group">Part 8: Caching and Incremental Compilation
    <div id="part-8-caching-and-incremental-compilation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-8-caching-and-incremental-compilation" aria-label="Anchor">#</a>
    </span>
    
</h1>
<p>In this article, we&rsquo;ll explore how Zig achieves remarkably fast compilation through smart caching and incremental compilation. This is the &ldquo;payoff&rdquo; - it explains <em>why</em> the previous articles&rsquo; design decisions were made.</p>
<hr>

<h2 class="relative group">Part 1: Why Does Compilation Speed Matter?
    <div id="part-1-why-does-compilation-speed-matter" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-1-why-does-compilation-speed-matter" aria-label="Anchor">#</a>
    </span>
    
</h2>

<h3 class="relative group">The Problem with Traditional Compilers
    <div id="the-problem-with-traditional-compilers" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#the-problem-with-traditional-compilers" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Imagine you&rsquo;re working on a large project with 1000 source files. You change ONE line in ONE file. What happens?</p>
<p><strong>Traditional approach (like old C compilers):</strong></p>
<pre tabindex="0"><code>Changed: utils.c (1 line)

Recompile: utils.c        → utils.o     (necessary)
Recompile: main.c         → main.o      (unnecessary!)
Recompile: network.c      → network.o   (unnecessary!)
Recompile: database.c     → database.o  (unnecessary!)
... 996 more files ...
Relink: everything        → program     (slow!)

Time: 5 minutes
</code></pre><p>You wait 5 minutes for a 1-line change. This destroys productivity.</p>
<p><strong>What we want:</strong></p>
<pre tabindex="0"><code>Changed: utils.c (1 line)

Recompile: utils.c        → utils.o     (necessary)
Skip: main.c              → (unchanged)
Skip: network.c           → (unchanged)
Skip: database.c          → (unchanged)
Incremental link: patch program

Time: 0.2 seconds
</code></pre>
<h3 class="relative group">The Core Insight
    <div id="the-core-insight" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#the-core-insight" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                    THE CACHING PRINCIPLE                     │
│                                                              │
│  If the INPUT hasn&#39;t changed, the OUTPUT won&#39;t change.      │
│                                                              │
│  So why recompute it?                                        │
└─────────────────────────────────────────────────────────────┘
</code></pre><p>This sounds simple, but implementing it correctly is hard:</p>
<ul>
<li>How do you know if the input &ldquo;changed&rdquo;?</li>
<li>What counts as &ldquo;input&rdquo;? (source code? compiler flags? dependencies?)</li>
<li>How do you store outputs efficiently?</li>
<li>How do you invalidate stale cache entries?</li>
</ul>
<p>Zig solves all of these problems elegantly.</p>
<hr>

<h2 class="relative group">Part 2: The Zig Cache Directory
    <div id="part-2-the-zig-cache-directory" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-2-the-zig-cache-directory" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>When you compile with Zig, it creates a cache directory. Let&rsquo;s explore it:</p>
<pre tabindex="0"><code>your-project/
├── src/
│   ├── main.zig
│   └── utils.zig
├── build.zig
└── zig-cache/              ← The cache directory
    ├── h/                  ← Hash-addressed storage
    │   ├── a1b2c3d4e5f6.../
    │   ├── f7e8d9c0b1a2.../
    │   └── ...
    ├── o/                  ← Object files
    │   ├── main.o
    │   └── utils.o
    └── z/                  ← ZIR cache
        ├── main.zig.zir
        └── utils.zig.zir
</code></pre>
<h3 class="relative group">What&rsquo;s in Each Directory?
    <div id="whats-in-each-directory" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#whats-in-each-directory" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p><strong>The <code>h/</code> directory - Hash-addressed storage:</strong></p>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                    CONTENT-ADDRESSED STORAGE                 │
│                                                              │
│  Instead of naming files by their path, name them by their  │
│  CONTENT. Two identical files = same name = stored once.    │
│                                                              │
│  File content: &#34;hello world&#34;                                 │
│  SHA256 hash:  a948904f2f0f479b8f...                        │
│  Stored as:    h/a948904f2f0f479b8f.../                      │
└─────────────────────────────────────────────────────────────┘
</code></pre><p>This is the same idea behind Git, Docker, and Nix!</p>
<p><strong>The <code>z/</code> directory - ZIR cache:</strong></p>
<pre tabindex="0"><code>Remember from Article 4: ZIR is generated per-file.

source: main.zig  ──────►  cached: main.zig.zir
source: utils.zig ──────►  cached: utils.zig.zir

If main.zig doesn&#39;t change, we skip ZIR generation entirely!
</code></pre><p><strong>The <code>o/</code> directory - Object files:</strong></p>
<pre tabindex="0"><code>Remember from Article 6: Code generation produces object files.

AIR: main   ──────►  cached: main.o
AIR: utils  ──────►  cached: utils.o

If the AIR doesn&#39;t change, we skip code generation!
</code></pre><hr>

<h2 class="relative group">Part 3: How Hashing Works
    <div id="part-3-how-hashing-works" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-3-how-hashing-works" aria-label="Anchor">#</a>
    </span>
    
</h2>

<h3 class="relative group">What Gets Hashed?
    <div id="what-gets-hashed" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#what-gets-hashed" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Zig doesn&rsquo;t just hash the source file. It hashes EVERYTHING that could affect the output:</p>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                     INPUTS TO THE HASH                       │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  1. Source code content (not filename, not timestamp!)      │
│                                                              │
│  2. Compiler version                                         │
│     (different compiler = different output)                  │
│                                                              │
│  3. Compiler flags                                           │
│     -O Debug vs -O ReleaseFast = different output            │
│                                                              │
│  4. Target architecture                                      │
│     x86_64-linux vs aarch64-macos = different output         │
│                                                              │
│  5. Dependencies (imports)                                   │
│     If @import(&#34;utils.zig&#34;) changes, main.zig must recompile │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 class="relative group">Example: Computing a Cache Key
    <div id="example-computing-a-cache-key" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#example-computing-a-cache-key" aria-label="Anchor">#</a>
    </span>
    
</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zig" data-lang="zig"><span class="line"><span class="cl"><span class="c1">// main.zig
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span><span class="w"> </span><span class="n">std</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&#34;std&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kr">const</span><span class="w"> </span><span class="n">utils</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">@import</span><span class="p">(</span><span class="s">&#34;utils.zig&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kr">pub</span><span class="w"> </span><span class="k">fn</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">utils</span><span class="p">.</span><span class="nf">greet</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>The cache key for main.zig includes:</p>
<pre tabindex="0"><code>Hash inputs:
  ├── content of main.zig:     sha256(&#34;const std = @import...&#34;)
  ├── compiler version:        0.12.0
  ├── optimization level:      Debug
  ├── target:                  x86_64-linux
  └── dependencies:
      ├── std:                 sha256(standard library content)
      └── utils.zig:           sha256(utils.zig content)

Combined hash: a1b2c3d4e5f6g7h8...
</code></pre>
<h3 class="relative group">Why Content, Not Timestamps?
    <div id="why-content-not-timestamps" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#why-content-not-timestamps" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Traditional build systems (like Make) use file modification times:</p>
<pre tabindex="0"><code>Make&#39;s approach:
  IF main.c is newer than main.o:
      Recompile main.c

Problems:
  1. Touch a file? Recompiles even though content unchanged
  2. Git checkout? All files get new timestamps, everything recompiles
  3. Copy file? Timestamp changes, unnecessary recompile
  4. Clock skew? Complete chaos
</code></pre><p>Zig&rsquo;s approach:</p>
<pre tabindex="0"><code>Zig&#39;s approach:
  IF hash(main.zig content) != cached hash:
      Recompile main.zig

Benefits:
  1. Touch a file? Same content, same hash, no recompile
  2. Git checkout? Same content, same hash, no recompile
  3. Copy file? Same content, same hash, no recompile
  4. Clock skew? Doesn&#39;t matter, we don&#39;t use time
</code></pre><hr>

<h2 class="relative group">Part 4: The Compilation Cache Layers
    <div id="part-4-the-compilation-cache-layers" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-4-the-compilation-cache-layers" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Zig caches at MULTIPLE levels of the pipeline:</p>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                    CACHE LAYERS                              │
│                                                              │
│  Source ──► Tokens ──► AST ──► ZIR ──► AIR ──► Code ──► Exe │
│              │          │       │       │       │            │
│              ▼          ▼       ▼       ▼       ▼            │
│           (not      (not    CACHED  CACHED  CACHED          │
│           cached)   cached)                                  │
│                                                              │
│  Why not cache tokens/AST?                                   │
│  - They&#39;re fast to regenerate                                │
│  - They&#39;re large to store                                    │
│  - ZIR is the sweet spot: compact + slow to generate         │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 class="relative group">Layer 1: ZIR Cache
    <div id="layer-1-zir-cache" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#layer-1-zir-cache" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>┌──────────────────────────────────────────────┐
│              ZIR CACHING                      │
├──────────────────────────────────────────────┤
│                                              │
│  Input:  Source file content                 │
│  Output: ZIR (Zig Intermediate Rep)          │
│                                              │
│  Cached because:                             │
│  - ZIR generation is expensive (parsing,    │
│    AST building, ZIR emission)              │
│  - ZIR is compact (much smaller than AST)   │
│  - ZIR is self-contained per file           │
│                                              │
│  Cache key: hash(source content)             │
│                                              │
└──────────────────────────────────────────────┘

Example:
  main.zig (1000 lines) → main.zig.zir (50 KB)

  First compile:  Parse + build AST + emit ZIR = 50ms
  Second compile: Load from cache = 2ms

  Speedup: 25x!
</code></pre>
<h3 class="relative group">Layer 2: Semantic Analysis Cache
    <div id="layer-2-semantic-analysis-cache" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#layer-2-semantic-analysis-cache" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>┌──────────────────────────────────────────────┐
│              SEMA CACHING                     │
├──────────────────────────────────────────────┤
│                                              │
│  This is trickier because Sema crosses files │
│                                              │
│  main.zig imports utils.zig                  │
│  If utils.zig changes, main.zig&#39;s Sema       │
│  might need to re-run (if it uses changed    │
│  declarations)                               │
│                                              │
│  Zig tracks FINE-GRAINED dependencies:       │
│  - Which declarations does each file use?    │
│  - Did those specific declarations change?   │
│                                              │
└──────────────────────────────────────────────┘

Example:
  // utils.zig
  pub fn greet() void { ... }      // main.zig uses this
  pub fn farewell() void { ... }   // main.zig doesn&#39;t use this

  If only farewell() changes:
    main.zig does NOT need to recompile!
    (It never used farewell)
</code></pre>
<h3 class="relative group">Layer 3: Code Generation Cache
    <div id="layer-3-code-generation-cache" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#layer-3-code-generation-cache" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>┌──────────────────────────────────────────────┐
│              CODEGEN CACHING                  │
├──────────────────────────────────────────────┤
│                                              │
│  Input:  AIR (per function)                  │
│  Output: Machine code / Object file          │
│                                              │
│  Key insight: AIR is per-FUNCTION            │
│                                              │
│  If you change function foo():               │
│  - Only foo()&#39;s codegen reruns               │
│  - bar(), baz() use cached machine code      │
│                                              │
└──────────────────────────────────────────────┘

Example:
  // Change ONE function in a file with 100 functions

  Traditional: Regenerate all 100 functions&#39; code
  Zig:         Regenerate 1 function, reuse 99 from cache
</code></pre>
<h3 class="relative group">Layer 4: Incremental Linking
    <div id="layer-4-incremental-linking" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#layer-4-incremental-linking" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>┌──────────────────────────────────────────────┐
│              INCREMENTAL LINKING              │
├──────────────────────────────────────────────┤
│                                              │
│  Traditional linking:                        │
│    Collect ALL object files                  │
│    Write entire executable from scratch      │
│                                              │
│  Incremental linking:                        │
│    Keep executable in memory                 │
│    Patch only the changed functions          │
│    Update symbol table                       │
│    Write minimal changes to disk             │
│                                              │
└──────────────────────────────────────────────┘

Example:
  Executable: 10 MB, 5000 functions
  Changed: 1 function (500 bytes)

  Traditional: Write 10 MB to disk
  Incremental: Write ~500 bytes to disk (patch in place)

  Speedup: 20000x for disk I/O!
</code></pre><hr>

<h2 class="relative group">Part 5: Dependency Tracking
    <div id="part-5-dependency-tracking" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-5-dependency-tracking" aria-label="Anchor">#</a>
    </span>
    
</h2>

<h3 class="relative group">The Dependency Graph
    <div id="the-dependency-graph" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#the-dependency-graph" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>When you compile a project, Zig builds a dependency graph:</p>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                    DEPENDENCY GRAPH                          │
│                                                              │
│                       main.zig                               │
│                      /    |    \                             │
│                     /     |     \                            │
│                    ▼      ▼      ▼                           │
│              utils.zig  http.zig  config.zig                 │
│                 |          |          |                      │
│                 ▼          ▼          ▼                      │
│              math.zig   tcp.zig   json.zig                   │
│                            |                                 │
│                            ▼                                 │
│                         ssl.zig                              │
│                                                              │
│  Arrow means &#34;imports&#34; / &#34;depends on&#34;                        │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 class="relative group">What Happens When a File Changes?
    <div id="what-happens-when-a-file-changes" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#what-happens-when-a-file-changes" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>Scenario: You edit ssl.zig

┌─────────────────────────────────────────────────────────────┐
│                  INVALIDATION CASCADE                        │
│                                                              │
│  1. ssl.zig changed                                          │
│     → ssl.zig must recompile                                 │
│                                                              │
│  2. tcp.zig imports ssl.zig                                  │
│     → Check: did tcp.zig USE what changed in ssl.zig?        │
│     → If yes: tcp.zig must recompile                         │
│     → If no: tcp.zig is still valid!                         │
│                                                              │
│  3. http.zig imports tcp.zig                                 │
│     → Only recompile if tcp.zig&#39;s INTERFACE changed          │
│                                                              │
│  4. Continue up the graph...                                 │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 class="relative group">Fine-Grained vs Coarse-Grained
    <div id="fine-grained-vs-coarse-grained" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#fine-grained-vs-coarse-grained" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p><strong>Coarse-grained (most compilers):</strong></p>
<pre tabindex="0"><code>ssl.zig changed
  → Recompile EVERYTHING that imports ssl.zig
  → Recompile EVERYTHING that imports those files
  → Basically recompile the world
</code></pre><p><strong>Fine-grained (Zig):</strong></p>
<pre tabindex="0"><code>ssl.zig changed
  → What SPECIFICALLY changed?
  → Only recompile files that USE those specific things

Example:
  // ssl.zig
  pub fn encrypt() { ... }     // You changed this
  pub fn decrypt() { ... }     // You didn&#39;t change this

  // tcp.zig
  const ssl = @import(&#34;ssl.zig&#34;);
  // Only uses decrypt()... doesn&#39;t need recompile!
</code></pre><hr>

<h2 class="relative group">Part 6: The InternPool - Deduplication Magic
    <div id="part-6-the-internpool---deduplication-magic" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-6-the-internpool---deduplication-magic" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Remember the InternPool from Article 5? It&rsquo;s crucial for caching:</p>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                    THE INTERNPOOL                            │
│                                                              │
│  Problem: Same type appears in many files                    │
│                                                              │
│  // file1.zig                                                │
│  var x: u32 = 0;                                             │
│                                                              │
│  // file2.zig                                                │
│  var y: u32 = 0;                                             │
│                                                              │
│  // file3.zig                                                │
│  var z: u32 = 0;                                             │
│                                                              │
│  Without InternPool: 3 copies of &#34;u32&#34; type info             │
│  With InternPool:    1 copy, referenced 3 times              │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 class="relative group">How InternPool Helps Caching
    <div id="how-internpool-helps-caching" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#how-internpool-helps-caching" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                INTERNPOOL + CACHING                          │
│                                                              │
│  1. IDENTITY COMPARISON                                      │
│     Two types are equal if they have the same InternPool ID  │
│     No need to deeply compare structures                     │
│                                                              │
│  2. STABLE IDENTIFIERS                                       │
│     Same type always gets same ID (within a compilation)     │
│     Makes cache keys deterministic                           │
│                                                              │
│  3. MEMORY EFFICIENCY                                        │
│     Don&#39;t store duplicate type info in cache                 │
│     One copy, many references                                │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre><hr>

<h2 class="relative group">Part 7: Incremental Compilation in Action
    <div id="part-7-incremental-compilation-in-action" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-7-incremental-compilation-in-action" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Let&rsquo;s trace through a real incremental compilation:</p>

<h3 class="relative group">Initial Compilation (Cold Cache)
    <div id="initial-compilation-cold-cache" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#initial-compilation-cold-cache" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>$ zig build

┌─────────────────────────────────────────────────────────────┐
│                  FIRST BUILD (COLD CACHE)                    │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Step 1: Parse all files                                     │
│    main.zig    → AST   (5ms)                                 │
│    utils.zig   → AST   (3ms)                                 │
│    network.zig → AST   (8ms)                                 │
│                                                              │
│  Step 2: Generate ZIR (and cache it)                         │
│    main.zig    → ZIR   (15ms)  → save to zig-cache/z/        │
│    utils.zig   → ZIR   (10ms)  → save to zig-cache/z/        │
│    network.zig → ZIR   (25ms)  → save to zig-cache/z/        │
│                                                              │
│  Step 3: Semantic analysis                                   │
│    Analyze all → AIR   (100ms)                               │
│                                                              │
│  Step 4: Code generation (and cache it)                      │
│    All funcs   → .o    (200ms) → save to zig-cache/o/        │
│                                                              │
│  Step 5: Linking                                             │
│    Link all    → exe   (50ms)                                │
│                                                              │
│  Total: 416ms                                                │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 class="relative group">Incremental Build (Warm Cache, Small Change)
    <div id="incremental-build-warm-cache-small-change" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#incremental-build-warm-cache-small-change" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>$ # Edit ONE line in utils.zig
$ zig build

┌─────────────────────────────────────────────────────────────┐
│               INCREMENTAL BUILD (WARM CACHE)                 │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Step 1: Check what changed                                  │
│    main.zig    → hash matches cache  → SKIP                  │
│    utils.zig   → hash DIFFERENT      → needs work            │
│    network.zig → hash matches cache  → SKIP                  │
│                                                              │
│  Step 2: ZIR generation                                      │
│    main.zig    → load from cache     (1ms)                   │
│    utils.zig   → regenerate          (10ms)                  │
│    network.zig → load from cache     (1ms)                   │
│                                                              │
│  Step 3: Semantic analysis                                   │
│    Check dependencies...                                     │
│    main.zig uses utils.greet() - did it change? NO           │
│    main.zig   → use cached results   (skip)                  │
│    utils.zig  → re-analyze           (15ms)                  │
│    network.zig → use cached results  (skip)                  │
│                                                              │
│  Step 4: Code generation                                     │
│    Only changed functions in utils.zig (5ms)                 │
│                                                              │
│  Step 5: Incremental linking                                 │
│    Patch executable in place         (3ms)                   │
│                                                              │
│  Total: 35ms (was 416ms - that&#39;s 12x faster!)                │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 class="relative group">The Speedup Scales
    <div id="the-speedup-scales" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#the-speedup-scales" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                    SCALING COMPARISON                        │
│                                                              │
│  Project Size     │ Cold Build │ Incremental │ Speedup      │
│  ─────────────────┼────────────┼─────────────┼───────────   │
│  10 files         │ 0.5s       │ 0.05s       │ 10x          │
│  100 files        │ 5s         │ 0.05s       │ 100x         │
│  1000 files       │ 50s        │ 0.05s       │ 1000x        │
│  10000 files      │ 500s       │ 0.05s       │ 10000x       │
│                                                              │
│  Key insight: Incremental time is nearly CONSTANT            │
│  (depends on size of change, not size of project)            │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre><hr>

<h2 class="relative group">Part 8: Cache Invalidation Strategies
    <div id="part-8-cache-invalidation-strategies" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-8-cache-invalidation-strategies" aria-label="Anchor">#</a>
    </span>
    
</h2>

<h3 class="relative group">The Two Hard Problems in Computer Science
    <div id="the-two-hard-problems-in-computer-science" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#the-two-hard-problems-in-computer-science" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>There are only two hard things in Computer Science:
  1. Cache invalidation
  2. Naming things
  3. Off-by-one errors
</code></pre><p>Cache invalidation is genuinely hard. When should you throw away cached data?</p>

<h3 class="relative group">Zig&rsquo;s Invalidation Rules
    <div id="zigs-invalidation-rules" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#zigs-invalidation-rules" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                 WHEN CACHE IS INVALIDATED                    │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  1. SOURCE CONTENT CHANGES                                   │
│     Hash of file content differs from cached hash            │
│                                                              │
│  2. COMPILER VERSION CHANGES                                 │
│     Upgraded Zig? All caches invalidated                     │
│     (Different compiler = different output)                  │
│                                                              │
│  3. COMPILER FLAGS CHANGE                                    │
│     -O Debug → -O ReleaseFast                                │
│     Completely different optimization = new cache            │
│                                                              │
│  4. TARGET CHANGES                                           │
│     Cross-compiling to different arch?                       │
│     Need different machine code                              │
│                                                              │
│  5. DEPENDENCY CHANGES                                       │
│     An imported file&#39;s interface changed                     │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 class="relative group">What DOESN&rsquo;T Invalidate Cache
    <div id="what-doesnt-invalidate-cache" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#what-doesnt-invalidate-cache" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│               WHAT DOESN&#39;T INVALIDATE CACHE                  │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  1. FILE TIMESTAMPS                                          │
│     Touch a file? Cache still valid                          │
│     Git checkout? Cache still valid                          │
│                                                              │
│  2. FILE RENAMES (with same content)                         │
│     mv foo.zig bar.zig                                       │
│     Content unchanged, cache still usable                    │
│                                                              │
│  3. WHITESPACE-ONLY CHANGES (in some cases)                  │
│     Add blank line? Might not affect ZIR                     │
│     (Depends on if line numbers are needed)                  │
│                                                              │
│  4. COMMENT CHANGES                                          │
│     Comments don&#39;t affect ZIR or codegen                     │
│     (But DO affect source locations for debugging)           │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre><hr>

<h2 class="relative group">Part 9: Parallel Compilation
    <div id="part-9-parallel-compilation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-9-parallel-compilation" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Caching enables aggressive parallelization:</p>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                  PARALLEL COMPILATION                        │
│                                                              │
│  Thread 1    Thread 2    Thread 3    Thread 4               │
│  ────────    ────────    ────────    ────────               │
│  main.zig    utils.zig   http.zig    json.zig               │
│     │           │           │           │                    │
│     ▼           ▼           ▼           ▼                    │
│   Parse       Parse       Parse       Parse                  │
│     │           │           │           │                    │
│     ▼           ▼           ▼           ▼                    │
│   ZIR         ZIR         ZIR         ZIR                    │
│     │           │           │           │                    │
│     └───────────┴─────┬─────┴───────────┘                    │
│                       │                                      │
│                       ▼                                      │
│              Semantic Analysis                               │
│            (must see all ZIR)                                │
│                       │                                      │
│     ┌─────────┬───────┼───────┬─────────┐                    │
│     ▼         ▼       ▼       ▼         ▼                    │
│  Codegen   Codegen  Codegen  Codegen  Codegen               │
│  (func1)   (func2)  (func3)  (func4)  (func5)               │
│     │         │       │       │         │                    │
│     └─────────┴───────┴───────┴─────────┘                    │
│                       │                                      │
│                       ▼                                      │
│                    Linking                                   │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 class="relative group">Cache + Parallelism = Speed
    <div id="cache--parallelism--speed" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#cache--parallelism--speed" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│               CACHE + PARALLELISM TOGETHER                   │
│                                                              │
│  Scenario: 100 files, you changed 2 files, 8 CPU cores       │
│                                                              │
│  Without cache, without parallelism:                         │
│    100 files × 50ms each = 5000ms                            │
│                                                              │
│  Without cache, with 8-way parallelism:                      │
│    100 files / 8 cores × 50ms = 625ms                        │
│                                                              │
│  With cache, without parallelism:                            │
│    2 files × 50ms = 100ms                                    │
│                                                              │
│  With cache AND parallelism:                                 │
│    2 files / 2 cores × 50ms = 50ms                           │
│                                                              │
│  Speedup from no optimizations: 100x!                        │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre><hr>

<h2 class="relative group">Part 10: Debugging Cache Issues
    <div id="part-10-debugging-cache-issues" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-10-debugging-cache-issues" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Sometimes caching causes confusion. Here&rsquo;s how to debug:</p>

<h3 class="relative group">Forcing a Clean Build
    <div id="forcing-a-clean-build" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#forcing-a-clean-build" aria-label="Anchor">#</a>
    </span>
    
</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># Remove the cache directory</span>
</span></span><span class="line"><span class="cl">rm -rf zig-cache
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Or use the built-in option</span>
</span></span><span class="line"><span class="cl">zig build --cache<span class="o">=</span>off
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Now everything rebuilds from scratch</span>
</span></span><span class="line"><span class="cl">zig build
</span></span></code></pre></td></tr></table>
</div>
</div>
<h3 class="relative group">Understanding Cache Misses
    <div id="understanding-cache-misses" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#understanding-cache-misses" aria-label="Anchor">#</a>
    </span>
    
</h3>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                 WHY IS MY FILE RECOMPILING?                  │
│                                                              │
│  Common causes:                                              │
│                                                              │
│  1. &#34;I only changed a comment!&#34;                              │
│     → Comments affect source locations for debug info        │
│     → If debug info is on, file must recompile               │
│                                                              │
│  2. &#34;I only changed a private function!&#34;                     │
│     → The FILE changed, so ZIR must regenerate               │
│     → But downstream files might not recompile               │
│                                                              │
│  3. &#34;I didn&#39;t change anything!&#34;                              │
│     → Check: did you upgrade Zig?                            │
│     → Check: did you change build options?                   │
│     → Check: did a dependency update?                        │
│                                                              │
│  4. &#34;Everything keeps recompiling!&#34;                          │
│     → Check: is a header/common file changing?               │
│     → Changing a widely-imported file affects many files     │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 class="relative group">Cache Inspection (Advanced)
    <div id="cache-inspection-advanced" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#cache-inspection-advanced" aria-label="Anchor">#</a>
    </span>
    
</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="c1"># See what&#39;s in the cache</span>
</span></span><span class="line"><span class="cl">ls -la zig-cache/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># See cache size</span>
</span></span><span class="line"><span class="cl">du -sh zig-cache/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Typical cache structure</span>
</span></span><span class="line"><span class="cl">zig-cache/
</span></span><span class="line"><span class="cl">├── h/          <span class="c1"># 50 MB  - hash-addressed artifacts</span>
</span></span><span class="line"><span class="cl">├── o/          <span class="c1"># 20 MB  - object files</span>
</span></span><span class="line"><span class="cl">├── z/          <span class="c1"># 5 MB   - ZIR files</span>
</span></span><span class="line"><span class="cl">└── tmp/        <span class="c1"># varies - temporary files during build</span>
</span></span></code></pre></td></tr></table>
</div>
</div><hr>

<h2 class="relative group">Part 11: The Complete Picture
    <div id="part-11-the-complete-picture" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#part-11-the-complete-picture" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Let&rsquo;s zoom out and see how caching fits into Zig&rsquo;s design:</p>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│                    THE COMPLETE PICTURE                      │
│                                                              │
│  ┌──────────────────────────────────────────────────────┐   │
│  │                    SOURCE FILES                       │   │
│  │          main.zig    utils.zig    http.zig           │   │
│  └──────────────────────────────────────────────────────┘   │
│                            │                                 │
│                            ▼                                 │
│  ┌──────────────────────────────────────────────────────┐   │
│  │                 HASHING LAYER                         │   │
│  │     &#34;Has this input changed since last time?&#34;         │   │
│  │     Content-addressed, not timestamp-based            │   │
│  └──────────────────────────────────────────────────────┘   │
│              │                              │                │
│         [changed]                      [unchanged]           │
│              │                              │                │
│              ▼                              ▼                │
│  ┌─────────────────────┐      ┌─────────────────────────┐   │
│  │    RECOMPILE        │      │    LOAD FROM CACHE      │   │
│  │  Parse → ZIR → ...  │      │    (instant!)           │   │
│  └─────────────────────┘      └─────────────────────────┘   │
│              │                              │                │
│              └──────────────┬───────────────┘                │
│                             ▼                                │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              SEMANTIC ANALYSIS (SEMA)                 │   │
│  │     Fine-grained dependency tracking                  │   │
│  │     Only re-analyze what&#39;s actually affected          │   │
│  └──────────────────────────────────────────────────────┘   │
│                             │                                │
│                             ▼                                │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              CODE GENERATION                          │   │
│  │     Per-function granularity                          │   │
│  │     Parallel across CPU cores                         │   │
│  └──────────────────────────────────────────────────────┘   │
│                             │                                │
│                             ▼                                │
│  ┌──────────────────────────────────────────────────────┐   │
│  │              INCREMENTAL LINKING                      │   │
│  │     Patch executable in place                         │   │
│  │     Minimal disk I/O                                  │   │
│  └──────────────────────────────────────────────────────┘   │
│                             │                                │
│                             ▼                                │
│  ┌──────────────────────────────────────────────────────┐   │
│  │                   EXECUTABLE                          │   │
│  │            Ready in milliseconds!                     │   │
│  └──────────────────────────────────────────────────────┘   │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre>
<h3 class="relative group">Why Each Design Decision Matters
    <div id="why-each-design-decision-matters" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#why-each-design-decision-matters" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Now we can see why the earlier articles&rsquo; designs enable fast caching:</p>
<pre tabindex="0"><code>┌─────────────────────────────────────────────────────────────┐
│            DESIGN DECISIONS AND THEIR PAYOFFS                │
├─────────────────────────────────────────────────────────────┤
│                                                              │
│  Article 4: ZIR is per-file                                  │
│  Payoff: Can cache/invalidate individual files               │
│                                                              │
│  Article 5: InternPool deduplicates types                    │
│  Payoff: Stable type IDs enable cache key computation        │
│                                                              │
│  Article 5: Sema tracks what each file uses                  │
│  Payoff: Fine-grained invalidation (not whole-file)          │
│                                                              │
│  Article 6: AIR is per-function                              │
│  Payoff: Can cache codegen at function granularity           │
│                                                              │
│  Article 7: Incremental linker                               │
│  Payoff: Patch-in-place instead of rewrite whole exe         │
│                                                              │
│  Everything connects! The whole compiler is designed         │
│  from the ground up for incremental compilation.             │
│                                                              │
└─────────────────────────────────────────────────────────────┘
</code></pre><hr>

<h2 class="relative group">Summary
    <div id="summary" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#summary" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Zig&rsquo;s caching and incremental compilation system is built on several key principles:</p>
<ol>
<li><strong>Content-addressed storage</strong>: Hash the content, not the filename or timestamp</li>
<li><strong>Multi-layer caching</strong>: Cache at ZIR, Sema, CodeGen, and linking stages</li>
<li><strong>Fine-grained dependencies</strong>: Track exactly what each file uses</li>
<li><strong>Minimal recompilation</strong>: Only redo work that&rsquo;s actually affected</li>
<li><strong>Incremental linking</strong>: Patch the executable instead of rebuilding it</li>
<li><strong>Parallelism</strong>: Work on independent files/functions simultaneously</li>
</ol>
<p>The result: Whether your project has 10 files or 10,000 files, incremental builds take about the same time - just a few milliseconds for small changes.</p>
<p>This is why Zig feels fast even for large projects. It&rsquo;s not magic - it&rsquo;s careful engineering at every level of the compiler, all designed to answer one question:</p>
<p><strong>&ldquo;What&rsquo;s the minimum work needed to produce the correct output?&rdquo;</strong></p>
<hr>
<p><em>Next article: We&rsquo;ll explore the Zig build system (build.zig) - how it uses comptime to create a build system that&rsquo;s both powerful and type-safe.</em></p>

          
          
          
        </div>
        
        

        

        

      </div>

      
      
        
        
          
          
        
        
        
        <script
          type="text/javascript"
          src="/js/page.min.54b6f4371722649edbe871e431d8670d670878c22be8f36e229fe53cc9b786fe25a834def5e6de621f7a3e37b72bc8cd73839aa5ed907ed6cbd45cd3e1b0fa20.js"
          integrity="sha512-VLb0NxciZJ7b6HHkMdhnDWcIeMIr6PNuIp/lPMm3hv4lqDTe9ebeYh96Pje3K8jNc4Oape2QftbL1FzT4bD6IA=="
          data-oid="views_drafts/08-caching-incremental.md"
          data-oid-likes="likes_drafts/08-caching-incremental.md"></script>
      
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span class="flex flex-col">
          
            <a
              class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/drafts/09-build-system/">
              <span class="leading-6">
                <span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Part 9: The Build System (build.zig)
              </span>
            </a>
            
              <span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2025-12-17T00:00:00&#43;00:00">December 17, 2025</time>
              </span>
            
          
        </span>
        <span class="flex flex-col items-end">
          
            <a
              class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/drafts/12-standard-library/">
              <span class="leading-6">
                Part 12: The Standard Library - Don't Reinvent the Wheel&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
              </span>
            </a>
            
              <span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2025-12-17T00:00:00&#43;00:00">December 17, 2025</time>
              </span>
            
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2025
          Yohai
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
  <script
    type="text/javascript"
    src="/js/process.min.ee03488f19c93c2efb199e2e3014ea5f3cb2ce7d45154adb3399a158cac27ca52831db249ede5bb602700ef87eb02434139de0858af1818ab0fb4182472204a4.js"
    integrity="sha512-7gNIjxnJPC77GZ4uMBTqXzyyzn1FFUrbM5mhWMrCfKUoMdsknt5btgJwDvh&#43;sCQ0E53ghYrxgYqw&#43;0GCRyIEpA=="></script>
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://localhost:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
